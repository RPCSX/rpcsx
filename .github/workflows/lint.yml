name: Linting
on:
  pull_request:
jobs:
  lint:
    name: Lint
    runs-on: ubuntu-latest
    steps:
    - name: Check out repo
      uses: actions/checkout@v1
    - name: Run clang-tidy
      uses: IsaacMarovitz/clang-tidy-review-16@1.0.0
      id: review
      with:
        clang_tidy_version: 16
        apt_packages: libunwind-dev, libglfw3-dev, libvulkan-dev, vulkan-validationlayers-dev, spirv-tools
        cmake_command: cmake . -DCMAKE_EXPORT_COMPILE_COMMANDS=on
        lgtm_comment_body: "No linting issues found!"

    # Uploads an artefact containing clang_fixes.json
    - name: Upload review
      uses: ZedThree/clang-tidy-review/upload@v0.13.1
      id: upload-review

    # If there are any comments, fail the check
    - if: steps.review.outputs.total_comments > 0
      run: exit 1